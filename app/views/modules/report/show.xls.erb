<?xml version="1.0"?>
<Workbook xmlns="urn:schemas-microsoft-com:office:spreadsheet" xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns:ss="urn:schemas-microsoft-com:office:spreadsheet" xmlns:html="http://www.w3.org/TR/REC-html40">
	<DocumentProperties xmlns="urn:schemas-microsoft-com:office:office">
		<Author><%=current_admin.fullname%></Author>
		<Created><%=Time.now%></Created>
		<Company>Searchin Company.</Company>
		<Version>1.0</Version>
	</DocumentProperties>
	<Styles>
		<Style ss:ID="Default" ss:Name="Default"/>
		<Style ss:ID="HPrincipal" ss:Name="HPrincipal">
			<Font ss:Bold="1" ss:Size="14"/>
			<Alignment ss:Horizontal="Left" ss:Vertical="Center" ss:Indent="0"/>
		</Style>
		<Style ss:ID="HCountry" ss:Name="HCountry">
			<Font ss:Bold="1" ss:Size="11"/>
			<Alignment ss:Horizontal="Left" ss:Vertical="Center" ss:Indent="0"/>
		</Style>
		<Style ss:ID="HTable" ss:Name="HTable">
			<Font ss:Bold="1" ss:Size="8"/>
			<Alignment ss:Horizontal="Center" ss:Vertical="Center" ss:Indent="0"/>
			<Borders>
				<Border ss:Position="Bottom" ss:LineStyle="Continuous" ss:Weight="1" ss:Color="#000000"/>
				<Border ss:Position="Left" ss:LineStyle="Continuous" ss:Weight="1" ss:Color="#000000"/>
				<Border ss:Position="Right" ss:LineStyle="Continuous" ss:Weight="1" ss:Color="#000000"/>
				<Border ss:Position="Top" ss:LineStyle="Continuous" ss:Weight="1" ss:Color="#000000"/>
			</Borders>
		</Style>

		<Style ss:ID="DNumber" ss:Name="DNumber">
			<Font ss:Size="9"/>
			<Alignment ss:Horizontal="Center" ss:Vertical="Center" ss:Indent="0"/>
			<Borders>
				<Border ss:Position="Bottom" ss:LineStyle="Continuous" ss:Weight="1" ss:Color="#000000"/>
				<Border ss:Position="Left" ss:LineStyle="Continuous" ss:Weight="1" ss:Color="#000000"/>
				<Border ss:Position="Right" ss:LineStyle="Continuous" ss:Weight="1" ss:Color="#000000"/>
				<Border ss:Position="Top" ss:LineStyle="Continuous" ss:Weight="1" ss:Color="#000000"/>
			</Borders>
		</Style>

		<Style ss:ID="DDots" ss:Name="DDots">
			<Font ss:Size="8"/>
			<Alignment ss:Horizontal="Left" ss:Vertical="Center" ss:Indent="0"/>
			<Borders>
				<Border ss:Position="Bottom" ss:LineStyle="Continuous" ss:Weight="1" ss:Color="#000000"/>
				<Border ss:Position="Left" ss:LineStyle="Continuous" ss:Weight="1" ss:Color="#000000"/>
				<Border ss:Position="Right" ss:LineStyle="Continuous" ss:Weight="1" ss:Color="#000000"/>
				<Border ss:Position="Top" ss:LineStyle="Continuous" ss:Weight="1" ss:Color="#000000"/>
			</Borders>
		</Style>
	</Styles>
	<Worksheet ss:Name="REPORTE GENERAL SEM <%=@selected_timeframe.n_number%>">
		<Table>
			<Column ss:Width="90"/>
			<Row>
				<Cell ><Data ss:Type="String"> </Data></Cell>
				<Cell ><Data ss:Type="String"> </Data></Cell>
			</Row>
			<Row ss:Height="18">
				<Cell ><Data ss:Type="String"> </Data></Cell>
				<Cell  ss:MergeAcross="7" ss:StyleID="HPrincipal"><Data ss:Type="String">REPORTE GENERAL Semana del <%=@selected_timeframe.starts_at.to_date%> al <%=@selected_timeframe.ends_at.to_date%></Data></Cell>
			</Row>
		<%@countries.each do |country| %>

			<Row>
				<Cell ><Data ss:Type="String"> </Data></Cell>
				<Cell ><Data ss:Type="String"> </Data></Cell>
			</Row>
			<Row>
				<Cell ><Data ss:Type="String"> </Data></Cell>
				<Cell ><Data ss:Type="String"> </Data></Cell>
			</Row>
			<Row ss:Height="15">
				
				<Cell ss:StyleID="HCountry"><Data ss:Type="String"><%=country.country.name.upcase%></Data></Cell>
				<Cell ><Data ss:Type="String"> </Data></Cell>
			</Row>
			<Row>
				<Cell ><Data ss:Type="String"> </Data></Cell>
				<Cell ><Data ss:Type="String"> </Data></Cell>
			</Row>

			<Row>
				<Cell ss:StyleID="HTable"><Data ss:Type="String">TALENT HUNTER</Data></Cell>
			<%country.countries_dots.order("countries_dots.dot_id ASC").each do |dot| %>
				<Cell ss:StyleID="HTable"><Data ss:Type="String"><%=dot.dot.name%></Data></Cell>
			<% end %>
			</Row>

			<%country.country.talent_hunters.where(:is_active=>true).each do |hunter| %>
			<Row>
				<Cell ss:StyleID="DDots"><Data ss:Type="String"><%=hunter.full_name.to_s.upcase%></Data></Cell>
				<% hunter.talent_hunters_dots.order("id ASC").each do |goal| %>
					<% scored=goal.dots_scoreds.includes(:work_timeframe).where("work_timeframes.n_number=?",@selected_timeframe.n_number).first %>
					<Cell  ss:StyleID="DNumber"><Data ss:Type="Number"><%=scored.total%></Data></Cell>
				<% end %>
			</Row>
			<% end %>
			<Row>
				<Cell ss:StyleID="HTable"><Data ss:Type="String">TOTAL</Data></Cell>
				<%country.countries_dots.order("countries_dots.dot_id ASC").each do |dot| %>
					<% total=0%>
					<% total=DotsScored.includes(:work_timeframe, :talent_hunters_dot=>[:dot, {:talent_hunter=>:country}]).where("countries.id=? and dots.id=? and work_timeframes.id=?",country.country_id,dot.dot.id,@selected_timeframe.id).sum("dots_scoreds.total") %>
					<Cell  ss:StyleID="DNumber"><Data ss:Type="Number"><%=total%></Data></Cell>
				<% end %>
			</Row>
		<% end %>
		</Table>
	</Worksheet>
</Workbook>